(this["webpackJsonpouterbridge-ui"]=this["webpackJsonpouterbridge-ui"]||[]).push([[11],{239:function(e,t,a){"use strict";var n=a(214);t.a={getAllWorkflows:function(){return n.a.get("/workflows")},getSpecificWorkflow:function(e){return n.a.get("/workflows/".concat(e))},createNewWorkflow:function(e){return n.a.post("/workflows",e)},updateWorkflow:function(e,t){return n.a.put("/workflows/".concat(e),t)},deployWorkflow:function(e,t){return n.a.post("/workflows/deploy/".concat(e),t||{})},deleteWorkflow:function(e){return n.a.delete("/workflows/".concat(e))},testWorkflow:function(e,t){return n.a.post("/workflows/test/".concat(e),t)}}},619:function(e,t,a){},664:function(e,t,a){"use strict";a.r(t);var n=a(203),r=a(218),o=a(7),c=a(15),i=a(0),s=a(308),l=a(204),d=a(384),u=a(306),j=a(385),b=a(25),h=a(14),p=a(30),O=a(16),f=a(674),x=a(186),m=a(192),g=a(193),v=a(682),w=a(694),y=a(26),k=a(9),S=a(150),C=a(104),R=a(209),E=a(33),I=a(34),D=a(1),T=Object(k.a)(R.a)((function(e){var t=e.theme;return{backgroundColor:"#ffffff",border:"solid 1px",color:t.darkTextPrimary,width:"200px",height:"auto",padding:"10px",boxShadow:"0 2px 14px 0 rgb(32 40 45 / 8%)","&:hover":{borderColor:t.palette.primary.main}}})),W=[[["50%"]],[["30%"],["70%"]]],N=function(e){var t=e.data,a=Object(y.a)();return Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(T,{content:!1,sx:{borderColor:t.selected?a.palette.primary.main:a.palette.text.secondary},border:!1,children:[t&&t.outputResponses&&t.outputResponses.submit&&Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)({},a.typography.smallAvatar),{},{borderRadius:"50%",background:a.palette.success.dark,color:"white",ml:2,position:"absolute",top:-10,right:-10}),children:Object(D.jsx)(E.d,{})}),t&&t.outputResponses&&t.outputResponses.needRetest&&Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)({},a.typography.smallAvatar),{},{borderRadius:"50%",background:a.palette.warning.dark,color:"white",ml:2,position:"absolute",top:-10,right:-10}),children:Object(D.jsx)(E.k,{})}),Object(D.jsxs)(x.a,{children:[t.inputAnchors.map((function(e,n){return Object(D.jsx)(s.b,{type:"target",position:l.j.Top,id:e.id,style:{height:15,width:15,top:-7.5,backgroundColor:t.selected?a.palette.primary.main:a.palette.text.secondary,left:W[t.inputAnchors.length-1][n]}},e.id)})),Object(D.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(D.jsx)(x.a,{item:!0,style:{width:50,marginRight:10},children:Object(D.jsx)("div",{style:Object(o.a)(Object(o.a)(Object(o.a)({},a.typography.commonAvatar),a.typography.largeAvatar),{},{backgroundColor:"white",cursor:"grab"}),children:Object(D.jsx)("img",{style:{width:"100%",height:"100%"},src:"".concat(I.a,"/api/v1/node-icon/").concat(t.name),alt:"Notification"})})}),Object(D.jsx)(x.a,{children:Object(D.jsx)(C.a,{sx:{fontSize:"1rem",fontWeight:500},children:t.label})})]}),t.outputAnchors.map((function(e,n){return Object(D.jsx)(s.b,{type:"source",position:l.j.Bottom,id:e.id,style:{height:15,width:15,bottom:-7.5,backgroundColor:t.selected?a.palette.primary.main:a.palette.text.secondary,left:W[t.outputAnchors.length-1][n]}},e.id)}))]})]})})},P=(a(619),function(e){var t=e.id,a=e.sourceX,n=e.sourceY,r=e.targetX,o=e.targetY,i=e.sourcePosition,l=e.targetPosition,d=e.style,u=void 0===d?{}:d,j=e.data,h=e.markerEnd,p=Object(s.e)({sourceX:a,sourceY:n,sourcePosition:i,targetX:r,targetY:o,targetPosition:l}),f=Object(s.f)({sourceX:a,sourceY:n,targetX:r,targetY:o}),x=Object(c.a)(f,2),m=x[0],g=x[1],v=Object(b.b)();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("path",{id:t,style:u,className:"react-flow__edge-path",d:p,markerEnd:h}),j&&j.label&&Object(D.jsx)(s.a,{x:a+10,y:n+10,label:j.label,labelStyle:{fill:"black"},labelBgStyle:{fill:"transparent"},labelBgPadding:[2,4],labelBgBorderRadius:2}),Object(D.jsx)("foreignObject",{width:40,height:40,x:m-20,y:g-20,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:Object(D.jsx)("div",{children:Object(D.jsx)("button",{type:"button",className:"edgebutton",onClick:function(e){return function(e,t){e.stopPropagation(),v({type:O.f,edgeId:t})}(e,t)},children:"\xd7"})})})]})}),A=a(148),B=a(654),z=a(151),M=a(665),F=a(3),L=a(250),V=a.n(L),H=a(681),q=a(191),J=a(187),U=a(676),Y=a(688),X=a(684),_=a(689),G=a(85),$=a.n(G),K=a(295),Z=a.n(K),Q=a(232),ee=a.n(Q),te=a(210),ae=a(655),ne=a(152),re=a(179),oe=a(133),ce=a(661),ie=["children","position","type","direction"],se=Object(i.forwardRef)((function(e,t){var a=e.children,n=e.position,r=e.type,c=e.direction,i=Object(te.a)(e,ie),s={transformOrigin:"0 0 0"};switch(n){case"top-right":s={transformOrigin:"top right"};break;case"top":s={transformOrigin:"top"};break;case"bottom-left":s={transformOrigin:"bottom left"};break;case"bottom-right":s={transformOrigin:"bottom right"};break;case"bottom":s={transformOrigin:"bottom"};break;default:s={transformOrigin:"0 0 0"}}return Object(D.jsxs)(x.a,{ref:t,children:["grow"===r&&Object(D.jsx)(ae.a,Object(o.a)(Object(o.a)({},i),{},{children:Object(D.jsx)(x.a,{sx:s,children:a})})),"collapse"===r&&Object(D.jsx)(ne.a,Object(o.a)(Object(o.a)({},i),{},{sx:s,children:a})),"fade"===r&&Object(D.jsx)(re.a,Object(o.a)(Object(o.a)({},i),{},{timeout:{appear:500,enter:600,exit:400},children:Object(D.jsx)(x.a,{sx:s,children:a})})),"slide"===r&&Object(D.jsx)(oe.a,Object(o.a)(Object(o.a)({},i),{},{timeout:{appear:0,enter:400,exit:200},direction:c,children:Object(D.jsx)(x.a,{sx:s,children:a})})),"zoom"===r&&Object(D.jsx)(ce.a,Object(o.a)(Object(o.a)({},i),{},{children:Object(D.jsx)(x.a,{sx:s,children:a})}))]})}));se.defaultProps={type:"grow",position:"top-left",direction:"up"};var le=se,de=a(24),ue=a(686),je=a(658),be=a(687),he=a(666),pe=a(691),Oe=["children","value","index"];function fe(e){var t=e.children,a=e.value,n=e.index,r=Object(te.a)(e,Oe);return Object(D.jsx)("div",Object(o.a)(Object(o.a)({role:"tabpanel",hidden:a!==n,id:"attachment-tabpanel-".concat(n),"aria-labelledby":"attachment-tab-".concat(n)},r),{},{children:a===n&&Object(D.jsx)(x.a,{sx:{p:1},children:t})}))}var xe=function(e){var t=e.show,a=e.dialogProps,n=e.onCancel,r=document.getElementById("portal"),s=Object(i.useState)(0),l=Object(c.a)(s,2),d=l[0],u=l[1],j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var a=1024,n=t<0?0:t,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,o)).toFixed(n))+" "+r[o]},b=t?Object(D.jsxs)(ue.a,{open:t,onClose:n,fullWidth:!0,maxWidth:"lg","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(D.jsx)(je.a,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title}),Object(D.jsxs)(be.a,{children:[Object(D.jsx)(he.a,{value:d,onChange:function(e,t){u(t)},"aria-label":"attachment tabs",children:a.executionData.map((function(e,t){return Object(D.jsx)(pe.a,Object(o.a)({label:"Item ".concat(t)},{id:"attachment-tab-".concat(a=t),"aria-controls":"attachment-tabpanel-".concat(a)}),t);var a}))}),a.executionData.map((function(e,t){return Object(D.jsxs)(fe,{value:d,index:t,children:[e.attachments&&e.attachments.map((function(e,t){return Object(D.jsxs)("div",{style:{marginBottom:10},children:[Object(D.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Object(D.jsxs)(C.a,{sx:{p:1},variant:"h5",children:[e.filename?e.filename:"Attachment ".concat(t)," | ",e.contentType," ",e.size?" | ".concat(j(e.size)):""]}),Object(D.jsx)("a",{href:e.content,download:!0,rel:"noopener noreferrer",target:"_blank",children:"Download File"})]}),Object(D.jsx)("embed",{src:e.content,width:"100%",height:"100%",type:e.contentType,style:{borderStyle:"solid",minHeight:"100vh",minWidth:"100vh"}})]},t)})),!e.attachments&&Object(D.jsx)("div",{children:"No Attachment"})]},t)}))]})]}):null;return Object(de.createPortal)(b,r)},me=["children","value","index"];function ge(e){var t=e.children,a=e.value,n=e.index,r=Object(te.a)(e,me);return Object(D.jsx)("div",Object(o.a)(Object(o.a)({role:"tabpanel",hidden:a!==n,id:"attachment-tabpanel-".concat(n),"aria-labelledby":"attachment-tab-".concat(n)},r),{},{children:a===n&&Object(D.jsx)(x.a,{sx:{p:1},children:t})}))}var ve,we=function(e){var t=e.show,a=e.dialogProps,n=e.onCancel,r=document.getElementById("portal"),s=Object(i.useState)(0),l=Object(c.a)(s,2),d=l[0],u=l[1],j=t?Object(D.jsxs)(ue.a,{open:t,onClose:n,fullWidth:!0,maxWidth:"lg","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(D.jsx)(je.a,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title}),Object(D.jsxs)(be.a,{children:[Object(D.jsx)(he.a,{value:d,onChange:function(e,t){u(t)},"aria-label":"attachment tabs",children:a.executionData.map((function(e,t){return Object(D.jsx)(pe.a,Object(o.a)({label:"Item ".concat(t)},{id:"attachment-tab-".concat(a=t),"aria-controls":"attachment-tabpanel-".concat(a)}),t);var a}))}),a.executionData.map((function(e,t){return Object(D.jsxs)(ge,{value:d,index:t,children:[e.html&&Object(D.jsx)("div",{style:{width:"100%",height:"100%",overflow:"auto"},dangerouslySetInnerHTML:{__html:e.html}}),!e.html&&Object(D.jsx)("div",{children:"No HTML"})]},t)}))]})]}):null;return Object(de.createPortal)(j,r)},ye=a(207),ke=function(e){var t=e.show,a=e.dialogProps,n=e.onCancel,r=e.onCopyClick,o=e.enableClipboard,c=document.getElementById("portal"),i=t?Object(D.jsxs)(ue.a,{open:t,fullWidth:!0,maxWidth:"md",onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(D.jsx)(je.a,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title}),Object(D.jsxs)(be.a,{children:[!o&&Object(D.jsx)(ee.a,{src:a.data,enableClipboard:function(e){return Object(ye.e)(e)}}),o&&Object(D.jsx)(ee.a,{src:a.data,enableClipboard:function(e){return r(e,a.node)}})]})]}):null;return Object(de.createPortal)(i,c)},Se=a(97),Ce=function(){var e=Object(i.useContext)(Se.a),t=Object(c.a)(e,2),a=t[0],n=t[1],r=function(){n({type:O.c})};return{confirm:function(e){return n({type:O.m,payload:e}),new Promise((function(e){ve=e}))},onConfirm:function(){r(),ve(!0)},onCancel:function(){r(),ve(!1)},confirmState:a}},Re=a(247),Ee=a(214),Ie=function(e){return Ee.a.delete("/executions/".concat(e))},De=a(239),Te=function(e){var t=e.workflowShortId,a=e.execution,s=e.executionCount,l=e.isExecutionOpen,d=e.anchorEl,u=Object(y.a)(),j=Object(i.useState)(!1),h=Object(c.a)(j,2),p=h[0],m=h[1],g=Object(i.useState)(!1),v=Object(c.a)(g,2),w=v[0],k=v[1],S=Object(i.useState)(!1),I=Object(c.a)(S,2),T=I[0],W=I[1],N=Object(i.useState)({}),P=Object(c.a)(N,2),A=P[0],M=P[1],L=Object(i.useState)(!1),G=Object(c.a)(L,2),K=G[0],Q=G[1],te=Object(i.useState)({}),ae=Object(c.a)(te,2),ne=ae[0],re=ae[1],oe=Object(i.useState)(!1),ce=Object(c.a)(oe,2),ie=ce[0],se=ce[1],de=Object(i.useState)({}),ue=Object(c.a)(de,2),je=ue[0],be=ue[1],he=Object(b.b)(),pe=Object(i.useRef)(w),Oe=Ce().confirm;Object(Re.a)();var fe=function(){return he(O.o.apply(void 0,arguments))},me=function(){return he(O.n.apply(void 0,arguments))},ge=function(e){return"INPROGRESS"===e?u.palette.warning.light:"FINISHED"===e?u.palette.success.light:"ERROR"===e?u.palette.error.light:"TERMINATED"===e||"TIMEOUT"===e?u.palette.grey[300]:u.palette.primary.light},ve=function(){var e=Object(r.a)(Object(n.a)().mark((function e(a,r){var o,c,i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.stopPropagation(),o={title:"Delete",description:"Delete execution ".concat(r,"?"),confirmButtonName:"Delete",cancelButtonName:"Cancel"},e.next=4,Oe(o);case 4:if(!e.sent){e.next=22;break}return e.prev=6,e.next=9,Ie(r);case 9:if(!e.sent.data){e.next=15;break}return e.next=13,De.a.getSpecificWorkflow(t);case 13:(c=e.sent).data&&he({type:O.l,workflow:c.data});case 15:fe({message:"Execution deleted!",options:{key:(new Date).getTime()+Math.random(),variant:"success",action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return me(e)},children:Object(D.jsx)(E.B,{})})}}}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),i=e.t0.response.data||"".concat(e.t0.response.status,": ").concat(e.t0.response.statusText),fe({message:i,options:{key:(new Date).getTime()+Math.random(),variant:"error",persist:!0,action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return me(e)},children:Object(D.jsx)(E.B,{})})}}});case 22:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t,a){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){pe.current=w}),[w]),Object(i.useEffect)((function(){k(l)}),[l]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(H.a,{placement:"bottom-end",open:w,anchorEl:d,role:void 0,transition:!0,disablePortal:!0,popperOptions:{modifiers:[{name:"offset",options:{offset:[170,20]}}]},sx:{zIndex:1e3},children:function(e){var t,n=e.TransitionProps;return Object(D.jsx)(le,Object(o.a)(Object(o.a)({in:w},n),{},{children:Object(D.jsx)(q.a,{children:Object(D.jsxs)(R.a,{border:!1,elevation:16,content:!1,boxShadow:!0,shadow:u.shadows[16],children:[Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(B.a,{children:Object(D.jsxs)(C.a,{variant:"h4",children:[s," Executions"]})})}),Object(D.jsxs)($.a,{style:{height:"100%",maxHeight:"calc(100vh - 250px)",overflowX:"hidden"},children:[0===s&&0===a.length&&Object(D.jsx)(x.a,{sx:{p:2},children:"No executions yet"}),s>0&&a.length>0&&Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(J.a,{sx:(t={width:"100%",maxWidth:330,py:0,borderRadius:"10px"},Object(F.a)(t,u.breakpoints.down("md"),{maxWidth:300}),Object(F.a)(t,"& .MuiListItemSecondaryAction-root",{top:22}),Object(F.a)(t,"& .MuiDivider-root",{my:0}),Object(F.a)(t,"& .list-container",{pl:7}),t),children:a&&a.map((function(e,t){return Object(D.jsx)(x.a,{children:Object(D.jsxs)(U.a,{expanded:p===e.shortId,onChange:(n=e.shortId,function(e,t){m(!!t&&n)}),children:[Object(D.jsx)(Y.a,{expandIcon:Object(D.jsx)(V.a,{}),"aria-controls":"".concat(e.shortId,"-content"),id:"".concat(e.shortId,"-header"),children:Object(D.jsxs)(B.a,{sx:{p:1,mr:1},direction:"column",children:[Object(D.jsxs)(B.a,{sx:{mb:1,alignItems:"center"},direction:"row",children:[Object(D.jsx)(C.a,{variant:"h5",children:e.shortId}),e.state&&Object(D.jsx)(z.a,{sx:{color:(a=e.state,"INPROGRESS"===a?u.palette.warning.dark:"FINISHED"===a?u.palette.success.dark:"ERROR"===a?u.palette.error.dark:"TERMINATED"===a||"TIMEOUT"===a?u.palette.grey[700]:u.palette.primary.dark),backgroundColor:ge(e.state),ml:1},label:e.state})]}),Object(D.jsxs)(B.a,{sx:{mb:-1,alignItems:"center"},direction:"row",children:[Object(D.jsx)(C.a,{variant:"h6",sx:{color:u.palette.grey[500]},children:Z()(e.createdDate).format("MMMM Do YYYY, h:mm:ss A z")}),Object(D.jsx)(X.a,{size:"small",sx:{height:25,width:25,ml:1},title:"Delete Execution",color:"error",onClick:function(t){return ve(t,e.shortId)},children:Object(D.jsx)(E.y,{})})]})]})}),JSON.parse(e.executionData).map((function(e,t){return Object(D.jsx)(_.a,{children:Object(D.jsxs)(x.a,{sx:{p:2,backgroundColor:u.palette.secondary.light,borderRadius:"15px",position:"relative"},children:[Object(D.jsx)(C.a,{sx:{p:1},variant:"h5",children:e.nodeLabel}),Object(D.jsx)(ee.a,{collapsed:!0,src:e.data,enableClipboard:function(e){return Object(ye.e)(e)}}),Object(D.jsx)(X.a,{size:"small",sx:{height:25,width:25,position:"absolute",top:5,right:5},title:"Expand Data",color:"primary",onClick:function(){return function(e,t){var a={title:"Execution Data: ".concat(t),data:e};be(a),se(!0)}(e.data,e.nodeLabel)},children:Object(D.jsx)(E.b,{})}),Object(D.jsx)("div",{children:e.data.map((function(t,a){return Object(D.jsxs)("div",{children:[t.html&&Object(D.jsx)(C.a,{sx:{p:1,mt:2},variant:"h5",children:"HTML"}),t.html&&Object(D.jsx)("div",{style:{width:"100%",height:"100%",maxHeight:400,overflow:"auto",backgroundColor:"white",borderRadius:5},dangerouslySetInnerHTML:{__html:t.html}}),t.html&&Object(D.jsx)(f.a,{sx:{mt:1},size:"small",variant:"contained",onClick:function(){return t=e.data,M({title:"HTML",executionData:t}),void W(!0);var t},children:"View HTML"}),t.attachments&&Object(D.jsx)(C.a,{sx:{p:1,pb:0,mt:2},variant:"h5",children:"Attachments"}),t.attachments&&t.attachments.map((function(t,n){return Object(D.jsxs)("div",{children:[Object(D.jsxs)(C.a,{sx:{p:1},variant:"h6",children:["Item ",a," | ",t.filename?t.filename:"Attachment ".concat(n)]}),Object(D.jsx)("embed",{src:t.content,width:"100%",height:"100%",style:{borderStyle:"solid"},type:t.contentType}),Object(D.jsx)(f.a,{size:"small",variant:"contained",onClick:function(){return t=e.data,re({title:"Attachments",executionData:t}),void Q(!0);var t},children:"View Attachment"})]},n)}))]},a)}))})]},t)},t)}))]})},t);var a,n}))})})]})]})})}))}}),Object(D.jsx)(xe,{show:K,dialogProps:ne,onCancel:function(){return Q(!1)}}),Object(D.jsx)(we,{show:T,dialogProps:A,onCancel:function(){return W(!1)}}),Object(D.jsx)(ke,{show:ie,dialogProps:je,onCancel:function(){return se(!1)}})]})},We=a(62),Ne={IconTrash:E.y,IconFileUpload:E.m,IconFileExport:E.l},Pe={id:"settings",title:"",type:"group",children:[{id:"loadWorkflow",title:"Load Workflow",type:"item",url:"",icon:Ne.IconFileUpload},{id:"exportWorkflow",title:"Export Workflow",type:"item",url:"",icon:Ne.IconFileExport},{id:"deleteWorkflow",title:"Delete Workflow",type:"item",url:"",icon:Ne.IconTrash}]},Ae=function(e){var t=e.workflow,a=e.isSettingsOpen,n=e.anchorEl,r=e.onSettingsItemClick,s=e.onUploadFile,l=Object(y.a)(),d=Object(i.useState)([]),u=Object(c.a)(d,2),j=u[0],b=u[1],h=Object(i.useState)(!1),p=Object(c.a)(h,2),O=p[0],f=p[1];Object(i.useEffect)((function(){if(t&&!t.shortId){var e=Pe.children.filter((function(e){return"loadWorkflow"===e.id}));b(e)}else if(t&&t.shortId){var a=Pe.children;b(a)}}),[t]),Object(i.useEffect)((function(){f(a)}),[a]);var m=j.map((function(e){return Object(D.jsx)(We.a,{item:e,level:1,navType:"SETTINGS",onClick:function(e){return r(e)},onUploadFile:s},e.id)}));return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(H.a,{placement:"bottom-end",open:O,anchorEl:n,role:void 0,transition:!0,disablePortal:!0,popperOptions:{modifiers:[{name:"offset",options:{offset:[170,20]}}]},sx:{zIndex:1e3},children:function(e){var t=e.TransitionProps;return Object(D.jsx)(le,Object(o.a)(Object(o.a)({in:O},t),{},{children:Object(D.jsx)(q.a,{children:Object(D.jsx)(R.a,{border:!1,elevation:16,content:!1,boxShadow:!0,shadow:l.shadows[16],children:Object(D.jsx)($.a,{style:{height:"100%",maxHeight:"calc(100vh - 250px)",overflowX:"hidden"},children:Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(J.a,{children:m})})})})})}))}})})},Be=a(685),ze=a(690),Me=function(e){var t=e.show,a=e.dialogProps,n=e.onCancel,r=e.onConfirm,o=document.getElementById("portal"),s=Object(i.useState)(""),l=Object(c.a)(s,2),d=l[0],u=l[1],j=Object(i.useState)(!1),b=Object(c.a)(j,2),h=b[0],p=b[1];Object(i.useEffect)((function(){p(!!d)}),[d]);var O=t?Object(D.jsxs)(ue.a,{open:t,fullWidth:!0,maxWidth:"xs",onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(D.jsx)(je.a,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title}),Object(D.jsx)(be.a,{children:Object(D.jsx)(Be.a,{sx:{mt:1},id:"workflow-name",type:"text",fullWidth:!0,placeholder:"My New Workflow",value:d,onChange:function(e){return u(e.target.value)}})}),Object(D.jsxs)(ze.a,{children:[Object(D.jsx)(f.a,{onClick:n,children:a.cancelButtonName}),Object(D.jsx)(f.a,{disabled:!h,variant:"contained",onClick:function(){return r(d)},children:a.confirmButtonName})]})]}):null;return Object(de.createPortal)(O,o)},Fe=a(215),Le=function(e){var t=e.workflow,a=e.handleSaveFlow,n=e.handleDeployWorkflow,r=e.handleStopWorkflow,s=e.handleDeleteWorkflow,l=e.handleLoadWorkflow,d=Object(y.a)(),u=Object(h.f)(),j=Object(i.useRef)(),p=Object(i.useRef)(),O=Object(i.useRef)(),f=Object(i.useState)(null),m=Object(c.a)(f,2),g=m[0],v=m[1],w=Object(i.useState)(""),k=Object(c.a)(w,2),R=k[0],I=k[1],T=Object(i.useState)(!1),W=Object(c.a)(T,2),N=W[0],P=W[1],F=Object(i.useState)(!1),L=Object(c.a)(F,2),V=L[0],H=L[1],q=Object(i.useState)(!1),J=Object(c.a)(q,2),U=J[0],Y=J[1],X=Object(Fe.a)(De.a.updateWorkflow),_=Object(b.c)((function(e){return e.canvas}));return Object(i.useEffect)((function(){X.data&&I(X.data.name),v(!1)}),[X.data]),Object(i.useEffect)((function(){t&&I(t.name)}),[t]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(x.a,{children:Object(D.jsx)(A.a,{title:"Back",sx:{borderRadius:"50%"},children:Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{transition:"all .2s ease-in-out",background:d.palette.secondary.light,color:d.palette.secondary.dark,"&:hover":{background:d.palette.secondary.dark,color:d.palette.secondary.light}}),color:"inherit",onClick:function(){return u(-1)},children:Object(D.jsx)(E.f,{stroke:1.5,size:"1.3rem"})})})}),Object(D.jsxs)(x.a,{sx:{flexGrow:1},children:[!g&&Object(D.jsxs)(B.a,{flexDirection:"row",children:[Object(D.jsxs)(C.a,{sx:{fontSize:"1.5rem",fontWeight:600,ml:2},children:[_.isDirty&&Object(D.jsx)("strong",{style:{color:d.palette.orange.main},children:"*"})," ",R]}),(null===t||void 0===t?void 0:t.shortId)&&Object(D.jsx)(A.a,{title:"Edit Name",sx:{borderRadius:"50%"},children:Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{transition:"all .2s ease-in-out",background:"white",color:d.palette.text.dark,ml:1,"&:hover":{background:d.palette.secondary.light,color:d.palette.secondary.dark}}),color:"inherit",onClick:function(){return v(!0)},children:Object(D.jsx)(E.s,{stroke:1.5,size:"1.3rem"})})}),(null===t||void 0===t?void 0:t.deployed)&&Object(D.jsx)(z.a,{sx:{color:d.palette.success.dark,backgroundColor:d.palette.success.light,ml:1},label:"Deployed",color:"success"})]}),g&&Object(D.jsxs)(B.a,{flexDirection:"row",children:[Object(D.jsx)(M.a,{size:"small",inputRef:j,sx:{width:"50%",ml:2},defaultValue:R}),Object(D.jsx)(A.a,{title:"Save Name",sx:{borderRadius:"50%"},children:Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{transition:"all .2s ease-in-out",background:"white",color:d.palette.text.dark,ml:1,"&:hover":{background:d.palette.secondary.light,color:d.palette.secondary.dark}}),color:"inherit",onClick:function(){if(t.shortId){var e={name:j.current.value};X.request(t.shortId,e)}},children:Object(D.jsx)(E.d,{stroke:1.5,size:"1.3rem"})})}),Object(D.jsx)(A.a,{title:"Cancel",sx:{borderRadius:"50%"},children:Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{transition:"all .2s ease-in-out",background:"white",color:d.palette.text.dark,ml:1,"&:hover":{background:d.palette.error.light,color:d.palette.error.dark}}),color:"inherit",onClick:function(){return v(!1)},children:Object(D.jsx)(E.B,{stroke:1.5,size:"1.3rem"})})})]})]}),Object(D.jsxs)(x.a,{children:[(null===t||void 0===t?void 0:t.shortId)&&Object(D.jsx)(A.a,{ref:p,title:"View Executions",sx:{borderRadius:"50%",mr:2},children:Object(D.jsxs)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{width:"54px",transition:"all .2s ease-in-out",background:d.palette.success.light,color:d.palette.success.dark,"&:hover":{background:d.palette.success.dark,color:d.palette.success.light}}),color:"inherit",onClick:function(){return P(!N)},children:[Object(D.jsx)("h6",{children:null===t||void 0===t?void 0:t.executionCount}),"\xa0",Object(D.jsx)(E.p,{stroke:1.5,size:"1.3rem"})]})}),(null===t||void 0===t?void 0:t.shortId)&&Object(D.jsx)(A.a,{title:null!==t&&void 0!==t&&t.deployed?"Stop Workflow":"Deploy Workflow",sx:{borderRadius:"50%",mr:2},children:Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{transition:"all .2s ease-in-out",background:d.palette.primary.light,color:d.palette.primary.dark,"&:hover":{background:d.palette.primary.dark,color:d.palette.primary.light}}),color:"inherit",onClick:null!==t&&void 0!==t&&t.deployed?r:n,children:null!==t&&void 0!==t&&t.deployed?Object(D.jsx)(E.t,{stroke:1.5,size:"1.3rem"}):Object(D.jsx)(E.v,{stroke:1.5,size:"1.3rem"})})}),Object(D.jsx)(A.a,{title:"Save Workflow",sx:{borderRadius:"50%",mr:2},children:Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{transition:"all .2s ease-in-out",background:d.palette.secondary.light,color:d.palette.secondary.dark,"&:hover":{background:d.palette.secondary.dark,color:d.palette.secondary.light}}),color:"inherit",onClick:function(){t.shortId?a(t.name):Y(!0)},children:Object(D.jsx)(E.i,{stroke:1.5,size:"1.3rem"})})}),Object(D.jsx)(A.a,{ref:O,title:"Settings",sx:{borderRadius:"50%"},children:Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)(Object(o.a)({},d.typography.commonAvatar),d.typography.mediumAvatar),{},{transition:"all .2s ease-in-out",background:d.palette.grey[300],color:d.palette.grey[700],"&:hover":{background:d.palette.grey[700],color:d.palette.grey[300]}}),onClick:function(){return H(!V)},children:Object(D.jsx)(E.x,{stroke:1.5,size:"1.3rem"})})})]}),(null===t||void 0===t?void 0:t.shortId)&&Object(D.jsx)(Te,{workflowShortId:null===t||void 0===t?void 0:t.shortId,execution:null===t||void 0===t?void 0:t.execution,executionCount:null===t||void 0===t?void 0:t.executionCount,isExecutionOpen:N,anchorEl:p.current}),Object(D.jsx)(Ae,{workflow:t,isSettingsOpen:V,anchorEl:O.current,onSettingsItemClick:function(e){if(H(!1),"deleteWorkflow"===e)s();else if("exportWorkflow"===e)try{var a=JSON.parse(t.flowData),n=JSON.stringify(Object(ye.f)(a)),r="data:application/json;charset=utf-8,"+encodeURIComponent(n),o="".concat(t.name," Workflow.json"),c=document.createElement("a");c.setAttribute("href",r),c.setAttribute("download",o),c.click()}catch(i){console.error(i)}},onUploadFile:function(e){H(!1),l(e)}}),Object(D.jsx)(Me,{show:U,dialogProps:{title:"Save New Workflow",confirmButtonName:"Save",cancelButtonName:"Cancel"},onCancel:function(){return Y(!1)},onConfirm:function(e){Y(!1),a(e)}})]})},Ve=a(141),He=a(692),qe=a(188),Je=a(145),Ue=a(671),Ye=a(693),Xe=a(154),_e=function(e){var t=e.nodesData,a=e.node,n=Object(y.a)(),r=Object(b.c)((function(e){return e.customization})),s=Object(i.useState)(""),l=Object(c.a)(s,2),d=l[0],u=l[1],j=Object(i.useState)([]),h=Object(c.a)(j,2),p=h[0],O=h[1],f=Object(i.useState)(!1),m=Object(c.a)(f,2),g=m[0],w=m[1],k=Object(i.useRef)(null),S=Object(i.useRef)(g),T=function(e){k.current&&k.current.contains(e.target)||w(!1)};return Object(i.useEffect)((function(){!0===S.current&&!1===g&&k.current.focus(),S.current=g}),[g]),Object(i.useEffect)((function(){a&&w(!1)}),[a]),Object(i.useEffect)((function(){t&&O(t)}),[t]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(v.a,{sx:{left:20,top:20},ref:k,size:"small",color:"primary","aria-label":"add",title:"Add Node",onClick:function(){w((function(e){return!e}))},children:g?Object(D.jsx)(E.r,{}):Object(D.jsx)(E.u,{})}),Object(D.jsx)(H.a,{placement:"bottom-end",open:g,anchorEl:k.current,role:void 0,transition:!0,disablePortal:!0,popperOptions:{modifiers:[{name:"offset",options:{offset:[-40,14]}}]},sx:{zIndex:1e3},children:function(e){var a,c=e.TransitionProps;return Object(D.jsx)(le,Object(o.a)(Object(o.a)({in:g},c),{},{children:Object(D.jsx)(q.a,{children:Object(D.jsx)(Ve.a,{onClickAway:T,children:Object(D.jsxs)(R.a,{border:!1,elevation:16,content:!1,boxShadow:!0,shadow:n.shadows[16],children:[Object(D.jsxs)(x.a,{sx:{p:2},children:[Object(D.jsx)(B.a,{children:Object(D.jsx)(C.a,{variant:"h4",children:"Add Nodes"})}),Object(D.jsx)(Be.a,{sx:{width:"100%",pr:1,pl:2,my:2},id:"input-search-node",value:d,onChange:function(e){return a=e.target.value,u(a),void setTimeout((function(){if(a){var e=t.filter((function(e){return e.name.toLowerCase().includes(a.toLowerCase())}));O(e)}else""===a&&O(t)}),500);var a},placeholder:"Search nodes",startAdornment:Object(D.jsx)(He.a,{position:"start",children:Object(D.jsx)(E.w,{stroke:1.5,size:"1rem",color:n.palette.grey[500]})}),"aria-describedby":"search-helper-text",inputProps:{"aria-label":"weight"}}),Object(D.jsx)(qe.a,{})]}),Object(D.jsx)($.a,{style:{height:"100%",maxHeight:"calc(100vh - 250px)",overflowX:"hidden"},children:Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(J.a,{sx:(a={width:"100%",maxWidth:330,py:0,borderRadius:"10px"},Object(F.a)(a,n.breakpoints.down("md"),{maxWidth:300}),Object(F.a)(a,"& .MuiListItemSecondaryAction-root",{top:22}),Object(F.a)(a,"& .MuiDivider-root",{my:0}),Object(F.a)(a,"& .list-container",{pl:7}),a),children:p.map((function(e){return Object(D.jsxs)("div",{onDragStart:function(t){return function(e,t){e.dataTransfer.setData("application/reactflow",JSON.stringify(t)),e.dataTransfer.effectAllowed="move"}(t,e)},draggable:!0,children:[Object(D.jsx)(Je.a,{sx:{p:0,borderRadius:"".concat(r.borderRadius,"px"),cursor:"move"},children:Object(D.jsxs)(Ue.a,{alignItems:"center",children:[Object(D.jsx)(Ye.a,{children:Object(D.jsx)("div",{style:{width:50,height:50,borderRadius:"50%",backgroundColor:"white"},children:Object(D.jsx)("img",{style:{width:"100%",height:"100%",padding:10,objectFit:"contain"},alt:e.name,src:"".concat(I.a,"/api/v1/node-icon/").concat(e.name)})})}),Object(D.jsx)(Xe.a,{sx:{ml:1},primary:e.label,secondary:e.description})]})}),Object(D.jsx)(qe.a,{})]},e.name)}))})})})]})})})}))}})]})},Ge=a(228),$e=a(220),Ke=a.n($e),Ze=a(278),Qe=a(279),et=a(386),tt=a(229),at=function(){return Ee.a.get("/nodes")},nt=function(e){return Ee.a.get("/nodes/".concat(e))},rt=function(e,t){return Ee.a.post("/node-test/".concat(e),t)},ot=function(){return Ee.a.post("/remove-test-triggers")},ct=function(e){var t=e.nodeId,a=e.nodeParamsType,o=e.nodeFlowData,s=e.nodes,l=e.edges,d=e.workflow,u=e.onSubmit,j=Object(y.a)(),b=Object(i.useState)([]),h=Object(c.a)(b,2),p=h[0],O=h[1],m=Object(i.useState)(null),g=Object(c.a)(m,2),v=g[0],k=g[1],S=Object(i.useState)(null),R=Object(c.a)(S,2),T=R[0],W=R[1],N=Object(i.useState)(null),P=Object(c.a)(N,2),A=P[0],M=P[1],F=Object(i.useState)(null),L=Object(c.a)(F,2),V=L[0],H=L[1],q=Object(i.useState)(!0),J=Object(c.a)(q,2),U=J[0],Y=J[1],_=Object(i.useState)(null),G=Object(c.a)(_,2),$=G[0],K=G[1],Z=Object(i.useState)(!1),Q=Object(c.a)(Z,2),te=Q[0],ae=Q[1],ne=Object(i.useState)({}),re=Object(c.a)(ne,2),oe=re[0],ce=re[1],ie=Object(i.useState)(!1),se=Object(c.a)(ie,2),le=se[0],de=se[1],ue=Object(i.useState)({}),je=Object(c.a)(ue,2),be=je[0],he=je[1],pe=Object(i.useState)(!1),Oe=Object(c.a)(pe,2),fe=Oe[0],me=Oe[1],ge=Object(i.useState)({}),ve=Object(c.a)(ge,2),Se=ve[0],Ce=ve[1],Re=Object(Fe.a)(rt);return Object(i.useEffect)((function(){o&&o.outputResponses&&o.outputResponses.output?O(o.outputResponses.output):O([]),Y(function(){for(var e=a.filter((function(e){return"outputResponses"!==e})),t=0;t<e.length;t+=1){var n=e[t];if(!o[n]||!o[n].submit)return!0}return!1}())}),[o,a]),Object(i.useEffect)((function(){if(s&&t){var e=s.find((function(e){return e.id===t}));e&&(W(e.data.name),M(e.data.type),H(e.data.label))}}),[s,t]),Object(i.useEffect)((function(){if(Re.data&&A&&"webhook"!==A){var e=Re.data;O(e),k(null),u({submit:!0,needRetest:null,output:e},"outputResponses")}}),[Re.data]),Object(i.useEffect)((function(){if(Re.error&&A&&"webhook"!==A){var e="Unexpected Error.";Re.error.response&&Re.error.response.data?e=Re.error.response.data:Re.error.message&&(e=Re.error.message),k(e),O([]);u({submit:null,needRetest:null,output:[]},"outputResponses")}}),[Re.error]),Object(i.useEffect)((function(){A&&"webhook"!==A&&K(Re.loading)}),[Re.loading]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(x.a,{sx:{width:400},children:[o&&o.outputResponses&&o.outputResponses.needRetest&&Object(D.jsx)(z.a,{sx:{mb:2},icon:Object(D.jsx)(E.k,{}),label:"Retest the node for updated parameters",color:"warning"}),T&&"webhook"===T&&Object(D.jsxs)(x.a,{sx:{mb:3},children:[Object(D.jsx)(C.a,{variant:"h5",sx:{mb:1},children:"".concat(I.a,"/api/v1/webhook/").concat(o.webhookEndpoint)}),Object(D.jsxs)(B.a,{direction:"row",spacing:2,children:[Object(D.jsx)(f.a,{size:"small",variant:"outlined",startIcon:Object(D.jsx)(E.h,{}),onClick:function(){return navigator.clipboard.writeText("".concat(I.a,"/api/v1/webhook/").concat(o.webhookEndpoint))},children:"Copy URL"}),Object(D.jsx)(f.a,{size:"small",variant:"outlined",startIcon:Object(D.jsx)(E.a,{}),onClick:function(){return window.open("".concat(I.a,"/api/v1/webhook/").concat(o.webhookEndpoint),"_blank")},children:"Open in New Tab"})]})]}),v&&Object(D.jsxs)(x.a,{sx:{mb:2},children:[Object(D.jsx)(z.a,{sx:{mb:2},icon:Object(D.jsx)(E.B,{}),label:"Error",color:"error"}),Object(D.jsx)("div",{style:{color:"red"},children:v})]}),Object(D.jsxs)(x.a,{sx:{position:"relative"},children:[Object(D.jsx)(ee.a,{collapsed:!0,src:p,enableClipboard:function(e){return Object(ye.e)(e)}}),Object(D.jsx)(X.a,{size:"small",sx:{height:25,width:25,position:"absolute",top:-5,right:5},title:"Expand Data",color:"primary",onClick:function(){return function(e){var t={title:"Output Responses: ".concat(V," "),data:e};Ce(t),me(!0)}(p)},children:Object(D.jsx)(E.b,{})}),Object(D.jsx)("div",{children:p.map((function(e,t){return Object(D.jsxs)("div",{children:[e.html&&Object(D.jsx)(C.a,{sx:{p:1,mt:2},variant:"h5",children:"HTML"}),e.html&&Object(D.jsx)("div",{style:{width:"100%",height:"100%",maxHeight:400,overflow:"auto",backgroundColor:"white",borderRadius:5},dangerouslySetInnerHTML:{__html:e.html}}),e.html&&Object(D.jsx)(f.a,{sx:{mt:1},size:"small",variant:"contained",onClick:function(){return ce({title:"HTML",executionData:p}),void ae(!0)},children:"View HTML"}),e.attachments&&Object(D.jsx)(C.a,{sx:{p:1,mt:2,pb:0},variant:"h5",children:"Attachments"}),e.attachments&&e.attachments.map((function(e,a){return Object(D.jsxs)("div",{children:[Object(D.jsxs)(C.a,{sx:{p:1},variant:"h6",children:["Item ",t," | ",e.filename?e.filename:"Attachment ".concat(a)]}),Object(D.jsx)("embed",{src:e.content,width:"100%",height:"100%",style:{borderStyle:"solid"},type:e.contentType}),Object(D.jsx)(f.a,{size:"small",variant:"contained",onClick:function(){return function(e){he({title:"Attachments",executionData:e}),de(!0)}(p)},children:"View Attachment"})]},a)}))]},t)}))})]}),Object(D.jsxs)(x.a,{sx:{mt:2,position:"relative"},children:[Object(D.jsx)(tt.a,{children:Object(D.jsx)(f.a,{disableElevation:!0,disabled:U||$,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"secondary",onClick:function(){return function(e){if(d.deployed)return K(!1),void alert("Testing trigger requires stopping workflow. Please stop workflow first");var a={nodes:s,edges:l,nodeId:t};try{if(K(!0),"webhook"===e){var c=Object(et.a)(I.a);c.on("connect",Object(r.a)(Object(n.a)().mark((function e(){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.clientId=c.id,Re.request(o.name,a);case 2:case"end":return e.stop()}}),e)})))),c.on("testWebhookNodeResponse",(function(e){O(e),K(!1),u({submit:!0,needRetest:null,output:e},"outputResponses"),c.disconnect()}))}else Re.request(o.name,a)}catch(i){K(!1),O([]),k(i),console.error(i)}}(A)},children:"Test Node"})}),$&&Object(D.jsx)(w.a,{size:24,sx:{color:j.palette.secondary.main,position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]})]}),Object(D.jsx)(xe,{show:le,dialogProps:be,onCancel:function(){return de(!1)}}),Object(D.jsx)(we,{show:te,dialogProps:oe,onCancel:function(){return ae(!1)}}),Object(D.jsx)(ke,{show:fe,dialogProps:Se,onCancel:function(){return me(!1)}})]})},it=function(e){var t=e.nodes,a=e.isVariableSelectorOpen,n=e.anchorEl,r=e.onVariableSelected,s=e.handleClose,l=Object(y.a)(),d=Object(i.useState)(!1),u=Object(c.a)(d,2),j=u[0],b=u[1],h=Object(i.useState)(!1),p=Object(c.a)(h,2),O=p[0],f=p[1],m=Object(i.useState)(!1),g=Object(c.a)(m,2),w=g[0],k=g[1],S=Object(i.useState)({}),I=Object(c.a)(S,2),T=I[0],W=I[1],N=Object(i.useRef)(O),P=function(e,t){for(var a=e.namespace,n="".concat(t.id),o=0;o<a.length;o+=1){var c=a[o];"root"!==c&&(/^\d+$/.test(c)?(n.endsWith(".")&&(n=n.substring(0,n.length-1)),n+="[".concat(c,"]")):n+=c,o!==a.length-1&&(n+="."))}r(n)};return Object(i.useEffect)((function(){N.current=O}),[O]),Object(i.useEffect)((function(){f(a)}),[a]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(H.a,{placement:"right-start",open:O,role:void 0,transition:!0,anchorEl:n,disablePortal:!0,popperOptions:{modifiers:[{name:"offset",options:{offset:[55,350]}}]},sx:{zIndex:900,width:350},children:function(e){var a,n=e.TransitionProps;return Object(D.jsx)(le,Object(o.a)(Object(o.a)({in:O},n),{},{children:Object(D.jsxs)(q.a,{children:[Object(D.jsx)(v.a,{sx:{minHeight:30,height:30,width:30,backgroundColor:l.palette.secondary.light,color:l.palette.secondary.main,position:"absolute",right:-10,top:-10},size:"small",onClick:s,children:Object(D.jsx)(E.B,{})}),Object(D.jsxs)(R.a,{border:!1,elevation:16,content:!1,boxShadow:!0,shadow:l.shadows[16],children:[Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(B.a,{children:Object(D.jsx)(C.a,{variant:"h4",children:"Variable Selector"})})}),Object(D.jsxs)($.a,{style:{height:"100%",maxHeight:"calc(100vh - 250px)",overflowX:"hidden"},children:[t&&0===t.length&&Object(D.jsx)(x.a,{sx:{p:2},children:"No variables"}),t&&t.length>0&&Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(J.a,{sx:(a={width:"100%",maxWidth:330,py:0,borderRadius:"10px"},Object(F.a)(a,l.breakpoints.down("md"),{maxWidth:300}),Object(F.a)(a,"& .MuiListItemSecondaryAction-root",{top:22}),Object(F.a)(a,"& .MuiDivider-root",{my:0}),Object(F.a)(a,"& .list-container",{pl:7}),a),children:t.map((function(e,t){return Object(D.jsx)(x.a,{children:Object(D.jsxs)(U.a,{expanded:j===e.data.label,onChange:(a=e.data.label,function(e,t){b(!!t&&a)}),children:[Object(D.jsx)(Y.a,{expandIcon:Object(D.jsx)(V.a,{}),"aria-controls":"".concat(e.data.label,"-content"),id:"".concat(e.data.label,"-header"),children:Object(D.jsx)(C.a,{variant:"h5",children:e.data.label})}),Object(D.jsx)(_.a,{children:Object(D.jsxs)("div",{style:{position:"relative"},children:[Object(D.jsx)(ee.a,{collapsed:!0,src:e.data.outputResponses?e.data.outputResponses.output:{},enableClipboard:function(t){return P(t,e)}}),Object(D.jsx)(X.a,{size:"small",sx:{height:25,width:25,position:"absolute",top:-5,right:5},title:"Expand Variable",color:"primary",onClick:function(){return function(e,t){var a={title:"Variable Data: ".concat(t.data.label),data:e,node:t};W(a),k(!0)}(e.data.outputResponses?e.data.outputResponses.output:{},e)},children:Object(D.jsx)(E.b,{})})]})})]})},t);var a}))})})]})]})]})}))}}),Object(D.jsx)(ke,{enableClipboard:!0,show:w,dialogProps:T,onCancel:function(){return k(!1)},onCopyClick:function(e,t){P(e,t),k(!1)}})]})},st=function(e){var t=e.node,a=e.nodes,n=e.edges,r=e.workflow,s=e.onNodeLabelUpdate,l=e.onNodeValuesUpdate,d=Object(y.a)(),u=Object(i.useState)(null),j=Object(c.a)(u,2),b=j[0],h=j[1],p=Object(i.useState)(""),O=Object(c.a)(p,2),f=O[0],m=O[1],g=Object(i.useState)(!1),w=Object(c.a)(g,2),k=w[0],I=w[1],T=Object(i.useState)(!1),W=Object(c.a)(T,2),N=W[0],P=W[1],A=Object(i.useState)(null),z=Object(c.a)(A,2),L=z[0],J=z[1],X=Object(i.useState)([]),G=Object(c.a)(X,2),K=G[0],Z=G[1],Q=Object(i.useState)([]),ee=Object(c.a)(Q,2),te=ee[0],ae=ee[1],ne=Object(i.useState)({}),re=Object(c.a)(ne,2),oe=re[0],ce=re[1],ie=Object(i.useState)({}),se=Object(c.a)(ie,2),de=se[0],ue=se[1],je=Object(i.useState)(!1),be=Object(c.a)(je,2),he=be[0],pe=be[1],Oe=Object(i.useState)({}),fe=Object(c.a)(Oe,2),xe=fe[0],me=fe[1],ge=Object(i.useState)(null),ve=Object(c.a)(ge,2),we=ve[0],ke=ve[1],Se=Object(i.useRef)(null),Ce=Object(i.useRef)(),Re=Object(Fe.a)(nt),Ee=function(){var e=Ce.current;e&&(e.scrollTop=0)},Ie=function(e){Se.current&&Se.current.contains(e.target)||(P(!1),pe(!1))},De=function(e){return function(t,a){I(!!a&&e),Ee()}},Te=function(e){m(e.target.value)},We=function(){s(f)},Ne=function(e,r){if(pe(e),r){me(r);for(var o=Object(ye.h)(a,n,t.id),c=[],i=function(e){var t=o[e],n=a.find((function(e){return e.id===t}));n&&n.data.outputResponses&&c.push(n)},s=0;s<o.length;s+=1)i(s);ke(c)}},Pe=function(e,t){var a=e.find((function(e){return"credentialMethod"===e.name})),n=e.findIndex((function(e){return"credentialMethod"===e.name}));if(void 0!==a){var r=L[t].find((function(e){return"credentialMethod"===e.name}));void 0!==r&&(e[n].options=r.options)}var c=Object(o.a)(Object(o.a)({},L),{},Object(F.a)({},t,e));J(c)},Ae=function(e,t){var a=Object(o.a)(Object(o.a)({},b),{},Object(F.a)({},t,e));if(b.outputResponses){var n=b.outputResponses;n.submit=null,n.needRetest=!0,a.outputResponses=n}h(a),l(a)},Be=function(e,t){var a=Object(o.a)(Object(o.a)({},b),{},Object(F.a)({},t,e));h(a),l(a);var n=te.indexOf(t);n>=0&&n!==te.length-1&&(I(te[n+1]),Ee())},ze=function(e,t,a,n){var r=e[t];Object.keys(r).forEach((function(o){var c=r[o];o.includes("$index")&&(o=o.replace("$index",a));var i=Ke.a.get(b,o,"");Array.isArray(c)?("show"!==t||c.includes(i)||n.push(e),"hide"===t&&c.includes(i)&&n.push(e)):"string"===typeof c&&("show"!==t||c===i||new RegExp(c).test(i)||n.push(e),"hide"!==t||c!==i&&!new RegExp(c).test(i)||n.push(e))}))},Me=function e(t,a,n){for(var r=[],o=0;o<t.length;o+=1){var c=t[o];if("array"===c.type){for(var i=Ke.a.get(b,"".concat(a,".").concat(c.name),[]),s=[],l=n;l<i.length;l+=1)s.push(e(c.array||[],a,l));c.arrayParams=s}c.show&&ze(c,"show",n,r),c.hide&&ze(c,"hide",n,r)}for(var d=t,u=function(e){d=d.filter((function(t){return JSON.stringify(t)!==JSON.stringify(r[e])}))},j=0;j<r.length;j+=1)u(j);return d},Le=function(e,t,a){for(var n=a,r=[],o=function(a){var o=n[a],c=o[e];c&&Object.keys(c).forEach((function(a){var n=c[a];a.includes("$index")&&(a=a.replace("$index",t));var i=Ke.a.get(b,a,"");Array.isArray(n)?("show"!==e||n.includes(i)||r.push(o),"hide"===e&&n.includes(i)&&r.push(o)):"string"===typeof n&&("show"!==e||n===i||new RegExp(n).test(i)||r.push(o),"hide"!==e||n!==i&&!new RegExp(n).test(i)||r.push(o))}))},c=0;c<n.length;c+=1)o(c);for(var i=function(e){n=n.filter((function(t){return JSON.stringify(t)!==JSON.stringify(r[e])}))},s=0;s<r.length;s+=1)i(s);return n},He=function e(t,a,n){for(var r=t,o=0;o<r.length;o+=1){var c=r[o];if("array"===c.type){for(var i=Ke.a.get(b,"".concat(a,".").concat(c.name),[]),s=[],l=n;l<i.length;l+=1)s.push(e(c.arrayParams[l]||[],a,l));c.arrayParams=s}"options"===c.type&&(c.options=Le("show",n,c.options),c.options=Le("hide",n,c.options))}return r},Je=function(e){var t={},a=Me(L[e]||[],e,0),n=He(Ke.a.cloneDeep(a),e,0);n=Object(ye.m)(n,e,a,b);for(var r=function(a){var r=n[a];if(e in b&&r.name in b[e])t[r.name]=b[e][r.name],"options"===r.type&&(r.options.find((function(e){return e.name===t[r.name]}))||delete t[r.name]);else if(t[r.name]=r.default||"","array"===r.type&&!r.default){for(var o={},c=0;c<r.array.length;c+=1)o[r.array[c].name]=r.array[c].default||"";t[r.name]=[o]}},o=0;o<n.length;o+=1)r(o);t.submit=null,ce(t),ue(function(e){for(var t={},a=0;a<e.length;a+=1){var n=e[a],r=n.optional;if("object"===typeof n.optional&&null!==n.optional){var o=Object.keys(n.optional);r=!0;for(var c=0;c<o.length;c+=1){var i=o[c],s=n.optional[i],l=Ke.a.get(b,i,"");Array.isArray(s)?r=r&&s.includes(l):"string"===typeof s&&(r=r&&(s===l||new RegExp(s).test(l)))}}"string"!==n.type&&"password"!==n.type&&"date"!==n.type&&"code"!==n.type&&"json"!==n.type&&"file"!==n.type&&"options"!==n.type&&"asyncOptions"!==n.type||r?"number"!==n.type||r?n.type:t[n.name]=Ge.c().required("".concat(n.label," is required. Type: ").concat(n.type)).matches(ye.o,"".concat(n.label," must be numbers or a variable expression.")):t[n.name]=Ge.c().required("".concat(n.label," is required. Type: ").concat(n.type))}return t}(n)),Z(n)},Ue=Object(i.useRef)(N);return Object(i.useEffect)((function(){!0===Ue.current&&!1===N&&Se.current.focus(),Ue.current=N}),[N]),Object(i.useEffect)((function(){if(Re.data){var e=Re.data;J(e);var t=[];e.actions&&t.push("actions"),e.networks&&t.push("networks"),e.credentials&&t.push("credentials"),e.inputParameters&&t.push("inputParameters"),t.push("outputResponses"),ae(t),t.length&&(I(t[0]),Ee())}}),[Re.data]),Object(i.useEffect)((function(){t&&(P(!0),m(t.data.label),h(t.data),Re.request(t.data.name))}),[t]),Object(i.useEffect)((function(){L&&b&&k&&Je(k)}),[L,b,k]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(v.a,{sx:{left:40,top:20},ref:Se,size:"small",color:"secondary",onClick:function(){P((function(e){return!e})),N&&pe(!1)},title:"Edit Node",children:N?Object(D.jsx)(E.r,{}):Object(D.jsx)(E.s,{})}),Object(D.jsx)(H.a,{placement:"bottom-end",open:N,anchorEl:Se.current,role:void 0,transition:!0,disablePortal:!0,popperOptions:{modifiers:[{name:"offset",options:{offset:[-80,14]}}]},sx:{zIndex:1e3},children:function(e){var c=e.TransitionProps;return Object(D.jsx)(le,Object(o.a)(Object(o.a)({in:N},c),{},{children:Object(D.jsx)(q.a,{children:Object(D.jsx)(Ve.a,{onClickAway:Ie,children:Object(D.jsxs)(R.a,{border:!1,elevation:16,content:!1,boxShadow:!0,shadow:d.shadows[16],children:[Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(B.a,{children:Object(D.jsx)(C.a,{variant:"h4",children:"Edit Nodes"})})}),Object(D.jsxs)($.a,{containerRef:function(e){Ce.current=e},style:{height:"100%",maxHeight:"calc(100vh - 250px)",overflowX:"hidden"},children:[!t&&Object(D.jsx)(x.a,{sx:{p:2},children:"No data"}),b&&b.label&&Object(D.jsxs)(x.a,{sx:{pl:4,pr:4,pt:2,pb:2,textAlign:"center",display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(D.jsx)(M.a,{id:b.name,label:"Node Label",variant:"outlined",value:f,onChange:Te,fullWidth:!0}),Object(D.jsx)(v.a,{sx:{minHeight:10,height:27,width:30,backgroundColor:d.palette.secondary.light,color:d.palette.secondary.main,ml:2},size:"small",title:"Validate and Save",onClick:We,children:Object(D.jsx)(E.d,{})})]}),te.includes("actions")&&Object(D.jsxs)(x.a,{sx:{p:2},children:[Object(D.jsxs)(U.a,{expanded:"actions"===k,onChange:De("actions"),children:[Object(D.jsxs)(Y.a,{expandIcon:Object(D.jsx)(V.a,{}),"aria-controls":"actions-content",id:"actions-header",children:[Object(D.jsx)(C.a,{variant:"h4",children:"Actions"}),b&&b.actions&&b.actions.submit&&Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)({},d.typography.smallAvatar),{},{borderRadius:"50%",background:d.palette.success.dark,color:"white",ml:2}),children:Object(D.jsx)(E.d,{})})]}),Object(D.jsx)(_.a,{children:Object(D.jsx)(Ze.a,{params:K,paramsType:"actions",initialValues:oe,nodeParamsValidation:de,nodeFlowData:b,setVariableSelectorState:Ne,valueChanged:Ae,onSubmit:Be},t.id)})]}),Object(D.jsx)(qe.a,{})]}),te.includes("networks")&&Object(D.jsxs)(x.a,{sx:{p:2},children:[Object(D.jsxs)(U.a,{expanded:"networks"===k,onChange:De("networks"),children:[Object(D.jsxs)(Y.a,{expandIcon:Object(D.jsx)(V.a,{}),"aria-controls":"networks-content",id:"networks-header",children:[Object(D.jsx)(C.a,{variant:"h4",children:"Networks"}),b&&b.networks&&b.networks.submit&&Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)({},d.typography.smallAvatar),{},{borderRadius:"50%",background:d.palette.success.dark,color:"white",ml:2}),children:Object(D.jsx)(E.d,{})})]}),Object(D.jsx)(_.a,{children:Object(D.jsx)(Ze.a,{params:K,paramsType:"networks",initialValues:oe,nodeParamsValidation:de,nodeFlowData:b,setVariableSelectorState:Ne,valueChanged:Ae,onSubmit:Be},t.id)})]}),Object(D.jsx)(qe.a,{})]}),te.includes("credentials")&&Object(D.jsxs)(x.a,{sx:{p:2},children:[Object(D.jsxs)(U.a,{expanded:"credentials"===k,onChange:De("credentials"),children:[Object(D.jsxs)(Y.a,{expandIcon:Object(D.jsx)(V.a,{}),"aria-controls":"credentials-content",id:"credentials-header",children:[Object(D.jsx)(C.a,{variant:"h4",children:"Credentials"}),b&&b.credentials&&b.credentials.submit&&Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)({},d.typography.smallAvatar),{},{borderRadius:"50%",background:d.palette.success.dark,color:"white",ml:2}),children:Object(D.jsx)(E.d,{})})]}),Object(D.jsx)(_.a,{children:Object(D.jsx)(Qe.a,{initialParams:K,paramsType:"credentials",initialValues:oe,initialValidation:de,valueChanged:Ae,paramsChanged:Pe,onSubmit:Be},t.id)})]}),Object(D.jsx)(qe.a,{})]}),te.includes("inputParameters")&&Object(D.jsxs)(x.a,{sx:{p:2},children:[Object(D.jsxs)(U.a,{expanded:"inputParameters"===k,onChange:De("inputParameters"),children:[Object(D.jsxs)(Y.a,{expandIcon:Object(D.jsx)(V.a,{}),"aria-controls":"inputParameters-content",id:"inputParameters-header",children:[Object(D.jsx)(C.a,{variant:"h4",children:"Input Parameters"}),b&&b.inputParameters&&b.inputParameters.submit&&Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)({},d.typography.smallAvatar),{},{borderRadius:"50%",background:d.palette.success.dark,color:"white",ml:2}),children:Object(D.jsx)(E.d,{})})]}),Object(D.jsx)(_.a,{children:Object(D.jsx)(Ze.a,{params:K,paramsType:"inputParameters",initialValues:oe,nodeParamsValidation:de,nodeFlowData:b,setVariableSelectorState:Ne,valueChanged:Ae,onSubmit:Be},t.id)})]}),Object(D.jsx)(qe.a,{})]}),L&&b&&Object(D.jsxs)(x.a,{sx:{p:2},children:[Object(D.jsxs)(U.a,{expanded:"outputResponses"===k,onChange:De("outputResponses"),children:[Object(D.jsxs)(Y.a,{expandIcon:Object(D.jsx)(V.a,{}),"aria-controls":"outputResponses-content",id:"outputResponses-header",children:[Object(D.jsx)(C.a,{variant:"h4",children:"Output Responses"}),b&&b.outputResponses&&b.outputResponses.submit&&Object(D.jsx)(S.a,{variant:"rounded",sx:Object(o.a)(Object(o.a)({},d.typography.smallAvatar),{},{borderRadius:"50%",background:d.palette.success.dark,color:"white",ml:2}),children:Object(D.jsx)(E.d,{})})]}),Object(D.jsx)(_.a,{children:Object(D.jsx)(ct,{nodeId:t.id,nodeParamsType:te,nodeFlowData:b,nodes:a,edges:n,workflow:r,onSubmit:Be},t.id)})]}),Object(D.jsx)(qe.a,{})]})]}),Object(D.jsx)(it,{nodes:we,isVariableSelectorOpen:he,anchorEl:Se.current,onVariableSelected:function(e){return function(e){if(xe){var t=xe.path,a=xe.paramsType,n="".concat(xe.textBeforeCursorPosition,"{{").concat(e,"}}").concat(xe.textAfterCursorPosition),r=Ke.a.cloneDeep(b);Ke.a.set(r,t,n),Ae(r[a],a)}}(e)},handleClose:function(){return pe(!1)}})]})})})}))}})]})},lt=a(695),dt=function(){var e=Ce(),t=e.onConfirm,a=e.onCancel,n=e.confirmState,r=document.getElementById("portal"),o=n.show?Object(D.jsxs)(ue.a,{fullWidth:!0,maxWidth:"xs",open:n.show,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(D.jsx)(je.a,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:n.title}),Object(D.jsx)(be.a,{children:Object(D.jsx)(lt.a,{sx:{color:"black"},id:"alert-dialog-description",children:n.description})}),Object(D.jsxs)(ze.a,{children:[Object(D.jsx)(f.a,{onClick:a,children:n.cancelButtonName}),Object(D.jsx)(f.a,{variant:"contained",onClick:t,children:n.confirmButtonName})]})]}):null;return Object(de.createPortal)(o,r)},ut=function(e){var t,a=e.show,n=e.dialogProps,r=e.onCancel,o=e.onItemClick,s=document.getElementById("portal"),l=Object(y.a)(),d=Object(b.c)((function(e){return e.customization})),u=Object(i.useState)(""),j=Object(c.a)(u,2),h=j[0],p=j[1],O=Object(i.useState)([]),f=Object(c.a)(O,2),m=f[0],g=f[1];Object(i.useEffect)((function(){n.nodes&&g(n.nodes)}),[n]);var v=a?Object(D.jsxs)(ue.a,{open:a,fullWidth:!0,maxWidth:"md",onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(D.jsx)(je.a,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:n.title}),Object(D.jsxs)(be.a,{children:[Object(D.jsx)(B.a,{children:Object(D.jsx)("span",{children:"Select a starting point to test from. Workflow will be executed from the starting point till the end."})}),Object(D.jsxs)(x.a,{sx:{p:2},children:[Object(D.jsx)(Be.a,{sx:{width:"100%",pr:1,pl:2,my:2},id:"input-search-node",value:h,onChange:function(e){return t=e.target.value,p(t),void setTimeout((function(){if(t){var e=n.nodes.filter((function(e){return e.data.label.toLowerCase().includes(t.toLowerCase())}));g(e)}else""===t&&g(n.nodes)}),500);var t},placeholder:"Search nodes",startAdornment:Object(D.jsx)(He.a,{position:"start",children:Object(D.jsx)(E.w,{stroke:1.5,size:"1rem",color:l.palette.grey[500]})}),"aria-describedby":"search-helper-text",inputProps:{"aria-label":"weight"}}),Object(D.jsx)(qe.a,{})]}),Object(D.jsx)("div",{children:Object(D.jsx)(x.a,{sx:{p:2},children:Object(D.jsx)(J.a,{sx:(t={width:"100%",py:0,borderRadius:"10px"},Object(F.a)(t,l.breakpoints.down("md"),{maxWidth:300}),Object(F.a)(t,"& .MuiListItemSecondaryAction-root",{top:22}),Object(F.a)(t,"& .MuiDivider-root",{my:0}),Object(F.a)(t,"& .list-container",{pl:7}),t),children:m.map((function(e){return Object(D.jsxs)("div",{children:[Object(D.jsx)(Je.a,{sx:{p:0,borderRadius:"".concat(d.borderRadius,"px")},onClick:function(){return o(e.id)},children:Object(D.jsxs)(Ue.a,{alignItems:"center",children:[Object(D.jsx)(Ye.a,{children:Object(D.jsx)("div",{style:{width:50,height:50,borderRadius:"50%",backgroundColor:"white"},children:Object(D.jsx)("img",{style:{width:"100%",height:"100%",padding:10,objectFit:"contain"},alt:e.data.name,src:"".concat(I.a,"/api/v1/node-icon/").concat(e.data.name)})})}),Object(D.jsx)(Xe.a,{sx:{ml:1},primary:e.data.label,secondary:e.data.description})]})}),Object(D.jsx)(qe.a,{})]},e.id)}))})})})]})]}):null;return Object(de.createPortal)(v,s)},jt=function(){return Ee.a.post("/remove-test-webhooks")},bt={customNode:N},ht={buttonedge:P};t.default=function(){var e=Object(y.a)(),t=Object(h.f)(),a=document.location.pathname.toString().split("/"),k=a[a.length-1]&&a[a.length-1].startsWith("W")?a[a.length-1]:"",S=Ce().confirm,C=Object(b.b)(),R=Object(b.c)((function(e){return e.canvas})),T=Object(i.useState)(R),W=Object(c.a)(T,2),N=W[0],P=W[1],A=Object(i.useState)(null),B=Object(c.a)(A,2),z=B[0],M=B[1],F=Object(i.useState)(!1),L=Object(c.a)(F,2),V=L[0],H=L[1],q=Object(i.useState)({}),J=Object(c.a)(q,2),U=J[0],Y=J[1],X=Object(i.useState)(!1),_=Object(c.a)(X,2),G=_[0],$=_[1];Object(Re.a)();var K=function(){return C(O.o.apply(void 0,arguments))},Z=function(){return C(O.n.apply(void 0,arguments))},Q=Object(s.h)(),ee=Object(c.a)(Q,3),te=ee[0],ae=ee[1],ne=ee[2],re=Object(s.g)(),oe=Object(c.a)(re,3),ce=oe[0],ie=oe[1],se=oe[2],le=Object(i.useState)(null),de=Object(c.a)(le,2),ue=de[0],je=de[1],be=Object(i.useState)(null),he=Object(c.a)(be,2),pe=he[0],Oe=he[1],fe=Object(i.useRef)(null),xe=Object(Fe.a)(at),me=Object(Fe.a)(ot),ge=Object(Fe.a)(jt),ve=Object(Fe.a)(De.a.createNewWorkflow),we=Object(Fe.a)(De.a.testWorkflow),ke=Object(Fe.a)(De.a.updateWorkflow),Se=Object(Fe.a)(De.a.getSpecificWorkflow),Ee=function(){var e=Object(r.a)(Object(n.a)().mark((function e(){var t,a,r,o,c,i,s,l,d,u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ue){e.next=30;break}if(t=ue.toObject(),a=JSON.stringify(t),e.prev=3,z.shortId){e.next=12;break}return o={name:z.name,deployed:!1,flowData:a},e.next=8,De.a.createNewWorkflow(o);case 8:c=e.sent,r=c.data,e.next=17;break;case 12:return i={flowData:a},e.next=15,De.a.updateWorkflow(z.shortId,i);case 15:s=e.sent,r=s.data;case 17:return C({type:O.e}),e.next=20,De.a.deployWorkflow(r.shortId);case 20:l=e.sent,d=l.data,C({type:O.l,workflow:d}),K({message:"Workflow deployed!",options:{key:(new Date).getTime()+Math.random(),variant:"success",action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}}),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(3),u=e.t0.response.data||"".concat(e.t0.response.status,": ").concat(e.t0.response.statusText),K({message:u,options:{key:(new Date).getTime()+Math.random(),variant:"error",persist:!0,action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}});case 30:case"end":return e.stop()}}),e,null,[[3,26]])})));return function(){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(r.a)(Object(n.a)().mark((function e(){var t,a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,De.a.deployWorkflow(z.shortId,{halt:!0});case 3:t=e.sent,a=t.data,C({type:O.l,workflow:a}),K({message:"Workflow stopped",options:{key:(new Date).getTime()+Math.random(),variant:"success",action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),r=e.t0.response.data||"".concat(e.t0.response.status,": ").concat(e.t0.response.statusText),K({message:r,options:{key:(new Date).getTime()+Math.random(),variant:"error",persist:!0,action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=Object(r.a)(Object(n.a)().mark((function e(){var a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={title:"Delete",description:"Delete workflow ".concat(z.name,"?"),confirmButtonName:"Delete",cancelButtonName:"Cancel"},e.next=3,S(a);case 3:if(!e.sent){e.next=15;break}return e.prev=5,e.next=8,De.a.deleteWorkflow(z.shortId);case 8:t(-1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),r=e.t0.response.data||"".concat(e.t0.response.status,": ").concat(e.t0.response.statusText),K({message:r,options:{key:(new Date).getTime()+Math.random(),variant:"error",persist:!0,action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}});case 15:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(){return e.apply(this,arguments)}}(),We=Object(i.useCallback)((function(e,t){Oe(t),ae((function(e){return e.map((function(e){return e.id===t.id?e.data=Object(o.a)(Object(o.a)({},e.data),{},{selected:!0}):e.data=Object(o.a)(Object(o.a)({},e.data),{},{selected:!1}),e}))}))})),Ne=Object(i.useCallback)((function(e){ae((function(t){return t.map((function(t){return t.id===pe.id&&(Object(ye.b)(e,ue.getNodes())?(t.data.label!==e&&setTimeout((function(){return Me()}),0),t.data=Object(o.a)(Object(o.a)({},t.data),{},{label:e})):K({message:"Duplicated node label",options:{key:(new Date).getTime()+Math.random(),variant:"error",persist:!0,action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}})),t}))}))})),Pe=Object(i.useCallback)((function(e){ae((function(t){return t.map((function(t){return t.id===pe.id&&(setTimeout((function(){return Me()}),0),t.data=Object(o.a)(Object(o.a)(Object(o.a)({},t.data),e),{},{selected:!0})),t}))}))})),Ae=Object(i.useCallback)((function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}),[]),Be=Object(i.useCallback)((function(e){e.preventDefault();var t=fe.current.getBoundingClientRect(),a=e.dataTransfer.getData("application/reactflow");if("undefined"!==typeof a&&a)if("webhook"!==(a=JSON.parse(a)).type&&"trigger"!==a.type||!Object(ye.c)(ue.getNodes())){"webhook"===a.type&&(a.webhookEndpoint=Object(ye.g)());var n=ue.project({x:e.clientX-t.left-100,y:e.clientY-t.top-50}),r=Object(ye.l)(a,ue.getNodes()),c={id:r,position:n,type:"customNode",data:Object(ye.a)(a,ue.getNodes(),r)};Oe(c),ae((function(e){return e.concat(c).map((function(e){return e.id===c.id?e.data=Object(o.a)(Object(o.a)({},e.data),{},{selected:!0}):e.data=Object(o.a)(Object(o.a)({},e.data),{},{selected:!1}),e}))})),setTimeout((function(){return Me()}),0)}else K({message:"Workflow can only contains 1 trigger or webhook node",options:{key:(new Date).getTime()+Math.random(),variant:"error",persist:!0,action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}})}),[ue]),ze=function(){C({type:O.e}),K({message:"Workflow saved",options:{key:(new Date).getTime()+Math.random(),variant:"success",action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}})},Me=function(){C({type:O.i})};return Object(i.useEffect)((function(){if(Se.data){var e=Se.data,t=e.flowData?JSON.parse(e.flowData):[];ae(t.nodes||[]),ie(t.edges||[]),C({type:O.l,workflow:e})}}),[Se.data]),Object(i.useEffect)((function(){if(ve.data){var e=ve.data;C({type:O.l,workflow:e}),ze(),window.history.replaceState(null,null,"/canvas/".concat(e.shortId))}}),[ve.data]),Object(i.useEffect)((function(){ke.data&&(C({type:O.l,workflow:ke.data}),ze())}),[ke.data]),Object(i.useEffect)((function(){we.error&&K({message:"Test workflow failed",options:{key:(new Date).getTime()+Math.random(),variant:"error",persist:!0,action:function(e){return Object(D.jsx)(f.a,{style:{color:"white"},onClick:function(){return Z(e)},children:Object(D.jsx)(E.B,{})})}}})}),[we.error]),Object(i.useEffect)((function(){if(ue){var e=ue.getEdges();ie(e.filter((function(e){return e.id!==N.removeEdgeId}))),Me()}}),[N.removeEdgeId]),Object(i.useEffect)((function(){return M(N.workflow)}),[N.workflow]),Object(i.useEffect)((function(){return me.request(),ge.request(),k?Se.request(k):(ae([]),ie([]),C({type:O.l,workflow:{name:"Untitled workflow"}})),xe.request(),function(){me.request(),ge.request(),setTimeout((function(){return C({type:O.e})}),0)}}),[]),Object(i.useEffect)((function(){P(R)}),[R]),Object(p.c)("You have unsaved changes! Do you want to navigate away?",N.isDirty),Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(x.a,{children:[Object(D.jsx)(m.a,{enableColorOnDark:!0,position:"fixed",color:"inherit",elevation:1,sx:{bgcolor:e.palette.background.default},children:Object(D.jsx)(g.a,{children:Object(D.jsx)(Le,{workflow:z,handleSaveFlow:function(e){if(ue){ae((function(e){return e.map((function(e){return e.data=Object(o.a)(Object(o.a)({},e.data),{},{selected:!1}),e}))}));var t=ue.toObject(),a=JSON.stringify(t);if(z.shortId){var n={name:e,flowData:a};ke.request(z.shortId,n)}else{var r={name:e,deployed:!1,flowData:a};ve.request(r)}}},handleDeployWorkflow:Ee,handleStopWorkflow:Ie,handleDeleteWorkflow:Te,handleLoadWorkflow:function(e){try{for(var t=JSON.parse(e),a=t.nodes||[],n=0;n<a.length;n+=1){var r=a[n].data;"webhook"===r.type&&(r.webhookEndpoint=Object(ye.g)())}ae(a),ie(t.edges||[]),Me()}catch(o){console.error(o)}}})})}),Object(D.jsx)(x.a,{sx:{marginTop:"70px",height:"90vh",width:"100%"},children:Object(D.jsx)("div",{className:"reactflow-parent-wrapper",children:Object(D.jsx)(s.c,{children:Object(D.jsx)("div",{className:"reactflow-wrapper",ref:fe,children:Object(D.jsxs)(s.d,{nodes:te,edges:ce,onNodesChange:ne,onNodeDoubleClick:We,onEdgesChange:se,onDrop:Be,onDragOver:Ae,onNodeDragStop:Me,nodeTypes:bt,edgeTypes:ht,onConnect:function(e){var t=Object(o.a)(Object(o.a)({},e),{},{type:"buttonedge",id:"".concat(e.source,"-").concat(e.sourceHandle,"-").concat(e.target,"-").concat(e.targetHandle),data:{label:Object(ye.i)(e.sourceHandle)}});ie((function(e){return Object(l.n)(t,e)})),Me()},onInit:je,fitView:!0,children:[Object(D.jsx)(d.a,{nodeStrokeColor:function(){return e.palette.primary.main},nodeColor:function(){return e.palette.primary.main},nodeBorderRadius:2}),Object(D.jsx)(u.a,{style:{display:"flex",flexDirection:"row",left:"50%",transform:"translate(-50%, -50%)"}}),Object(D.jsx)(j.a,{color:"#aaa",gap:16}),Object(D.jsx)(_e,{nodesData:xe.data,node:pe}),Object(D.jsx)(st,{nodes:te,edges:ce,node:pe,workflow:z,onNodeLabelUpdate:Ne,onNodeValuesUpdate:Pe}),Object(D.jsx)(v.a,{sx:{position:"absolute",right:20,top:20},size:"small",color:"warning","aria-label":"test",title:"Test Workflow",disabled:G,onClick:function(){try{if(z.deployed)return void alert("Testing workflow requires stopping deployed workflow. Please stop deployed workflow first");var e=ue.toObject().nodes||[];H(!0),Y({title:"Test Workflow",nodes:e.filter((function(e){return!e.id.includes("ifElse")}))})}catch(t){console.error(t)}},children:Object(D.jsx)(E.c,{})}),G&&Object(D.jsx)(w.a,{size:50,sx:{color:e.palette.warning.dark,position:"absolute",right:15,top:15}})]})})})})}),Object(D.jsx)(dt,{}),Object(D.jsx)(ut,{show:V,dialogProps:U,onCancel:function(){return H(!1)},onItemClick:function(e){try{var t=Object(et.a)(I.a),a=ue.toObject(),n=a.nodes||[],r=a.edges||[];H(!1),t.on("connect",(function(){var a=t.id,c=n.find((function(t){return t.id===e})).data,i={nodes:n,edges:r,clientId:a,nodeData:c};we.request(e,i),ae((function(e){return e.map((function(e){return e.data=Object(o.a)(Object(o.a)({},e.data),{},{outputResponses:{submit:null,needRetest:null,output:null},selected:!1}),e}))})),$(!0)})),t.on("testWorkflowNodeResponse",(function(e){var t=e.nodeId,a=e.data,r=e.status,c=n.find((function(e){return e.id===t}));if(c){var i={submit:"FINISHED"===r||null,needRetest:"FINISHED"!==r||null,output:a},s=c.data;s.outputResponses=i,ae((function(e){return e.map((function(e){return e.id===t&&(e.data=Object(o.a)(Object(o.a)({},s),{},{selected:!1})),e}))}))}})),t.on("testWorkflowNodeFinish",(function(){$(!1),t.disconnect()}))}catch(c){console.error(c)}}})]})})}}}]);
//# sourceMappingURL=11.05e0ad8e.chunk.js.map